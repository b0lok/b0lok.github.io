<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Netflix Replica</title>
  <link rel="stylesheet" href="stylesdev.css" />
  <link rel="icon" href="./favicon.ico" type="image/png">
</head>
<body>
  <!-- Netflix Header -->
  <header class="nf-header">
    <div class="nf-logo">Netflix</div>
  </header>

  <!-- Video Section -->
  <section class="nf-player-container">
    <video 
      class="html5-main-video" 
      src="https://www.w3schools.com/html/mov_bbb.mp4" 
      controls
      poster="Netflix.png">
      <track kind="subtitles" src="subtitles-en.vtt" srclang="en" label="English" default>
      <track kind="subtitles" src="subtitles-ko.vtt" srclang="ko" label="Korean">
    </video>
    <div class="player-timedtext-text-container"></div>
  </section>

  <!-- Prepopulate Local Storage -->
  <script>
    async function setupLocalStorage() {
      localStorage.setItem('currentMovieId', '123456');
      localStorage.setItem(
        'availableLanguages',
        JSON.stringify([
          { id: 'en', description: 'English' },
          { id: 'ko', description: 'Korean' },
        ])
      );

      const subtitles = [
        { key: 'subtitle-en', url: 'subtitles-en.vtt' },
        { key: 'subtitle-ko', url: 'subtitles-ko.vtt' },
      ];

      subtitles.forEach(async ({ key, url }) => {
        try {
          const response = await fetch(url);
          if (!response.ok) {
            console.error(`Failed to fetch ${url}:`, response.statusText);
            return;
          }
          const text = await response.text();
          localStorage.setItem(key, text);
          console.log(`Loaded ${key} into localStorage.`);
        } catch (error) {
          console.error(`Error fetching ${url}:`, error);
        }
      });
    }
    setupLocalStorage();
  </script>

  <!-- Emulate Netflix DOM Structure -->
  <script>
    function emulateNetflixStructure() {
      const playerContainer = document.createElement('div');
      playerContainer.setAttribute('data-uia', 'player');

      const videoCanvas = document.createElement('div');
      videoCanvas.setAttribute('data-uia', 'video-canvas');
      const video = document.querySelector('video');
      if (video) {
        videoCanvas.appendChild(video);
        playerContainer.appendChild(videoCanvas);
        document.body.appendChild(playerContainer);
      }
    }
    emulateNetflixStructure();
  </script>
</body>
</html>
